<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paint - Editor</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>

<body>

    <div id="initialJSON" style="display: none;" th:text="${content}"></div>

    <div class="container-fluid mt-4">
        <div class="row">

            <div class="col-lg-3">
                <div class="welcome-card p-3 mb-3">
                    <h5 class="text-warning">Eines</h5>

                    <div id="tool-select" class="btn-group w-100 mb-2" role="group">
                        <button type="button" class="btn btn-outline-warning tool-btn active" data-tool="freehand" title="Llapis">
                            <i class="bi bi-brush"></i>
                        </button>
                        <button type="button" class="btn btn-outline-warning tool-btn" data-tool="line" title="Linia">
                            <i class="bi bi-dash-lg"></i>
                        </button>
                        <button type="button" class="btn btn-outline-warning tool-btn" data-tool="circle" title="Cercle">
                            <i class="bi bi-circle"></i>
                        </button>
                        <button type="button" class="btn btn-outline-warning tool-btn" data-tool="square" title="Quadrat">
                            <i class="bi bi-square"></i>
                        </button>
                        <button type="button" class="btn btn-outline-warning tool-btn" data-tool="star" title="Estrella">
                            <i class="bi bi-star"></i>
                        </button>
                    </div>

                    <div class="d-grid mb-3">
                        <button type="button" class="btn btn-outline-warning toggle-btn" id="fill-btn">
                            <i class="bi bi-paint-bucket"></i> Omplir Figura
                        </button>
                    </div>

                    <div class="mb-3">
                        <label for="color-picker" class="form-label text-secondary">Color</label>
                        <input type="color" class="form-control form-control-color w-100" id="color-picker" value="#FF0000" title="Tria un color">
                    </div>

                    <div class="mb-3">
                        <label for="size-slider" class="form-label text-secondary">Grandaria: <span id="size-value">5</span>px</label>
                        <input type="range" class="form-range" min="1" max="50" value="5" id="size-slider">
                    </div>

                    <div class="d-grid gap-2 d-md-flex justify-content-md-start mb-3">
                        <button type="button" class="btn btn-danger flex-grow-1" id="clear-canvas-btn">Netejar tot</button>
                        <div class="btn-group">
                            <button type="button" class="btn btn-outline-secondary" id="undo-btn" title="Desfer">
                                <i class="bi bi-arrow-counterclockwise"></i>
                            </button>
                            <button type="button" class="btn btn-outline-secondary" id="redo-btn" title="Refer">
                                <i class="bi bi-arrow-clockwise"></i>
                            </button>
                        </div>
                    </div>

                    <hr class="text-secondary">

                    <h5 class="text-warning mt-3">Objectes</h5>
                    <ul id="object-list" class="list-group" style="max-height: 250px; overflow-y: auto; background-color: #333;">
                    </ul>

                    <hr class="text-secondary">

                    <div class="d-grid">
                        <a href="/private" class="btn btn-outline-secondary">Sortir</a>
                    </div>
                </div>
            </div>

            <div class="col-lg-9">
                <div class="welcome-card p-3">
                    <canvas id="mycanvas" width="800" height="600" 
                            style="width: 100%; height: auto; max-width: 800px; background-color: white; border-radius: 0.25rem;">
                        El teu navegador no suporta canvas.
                    </canvas>

                    <form action="/canvas" method="post" id="save-form" class="mt-4 text-start">
                        
                        <input type="hidden" name="id" th:value="${canvas.id}">

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="name" name="name" 
                                           placeholder="Nom del dibuix" th:value="${canvas.name}">
                                    <label for="name">Nom del dibuix</label>
                                </div>
                            </div>

                            <div class="col-md-6 mb-3 d-flex align-items-center">
                                <div class="text-secondary me-3">Visibilitat:</div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="permission" id="private" value="private"
                                           th:checked="${canvas.permission == 'private' or canvas.permission == null}">
                                    <label class="form-check-label text-secondary" for="private">Privat</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="permission" id="public" value="public"
                                           th:checked="${canvas.permission == 'public'}">
                                    <label class="form-check-label text-secondary" for="public">PÃºblic</label>
                                </div>
                            </div>
                        </div>

                        <input type="hidden" id="drawingContent" name="content">

                        <div class="d-grid">
                            <button type="submit" class="btn btn-warning btn-lg" id="submit-btn">Guardar Dibuix</button>
                        </div>
                    </form>
                </div>
            </div>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script th:src="@{/js/canvas.js}"></script>
</body>

</html>